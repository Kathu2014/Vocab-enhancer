from flask import Flask, render_template, request, jsonify
import random

app = Flask(__name__)

# Word pool for different age groups
words = {
    '2-4': {
        'apple': "A fruit that is red or green, often eaten by children.",
        'dog': "A common pet with four legs that barks.",
        'milk': "A white liquid that comes from cows, often drunk by babies.",
        'ball': "A round object used in many games.",
        'sun': "The star that gives us light and warmth."
    },
    '5-7': {
        'table': "A piece of furniture with four legs used for eating or writing.",
        'bicycle': "A two-wheeled vehicle that you pedal.",
        'school': "A place where children go to learn.",
        'family': "A group of people related to each other.",
        'computer': "A device used for work, play, or learning."
    }
}

# Route to serve the game page
@app.route('/')
def index():
    return render_template('index.html')

# Route to generate a new word based on the selected age group
@app.route('/new_word', methods=['POST'])
def new_word():
    age_range = request.form['age_range']
    word_pool = words[age_range]
    word, hint = random.choice(list(word_pool.items()))
    return jsonify({'word': word, 'hint': hint, 'attempts_left': 3})

# Route to check the guess
@app.route('/check_guess', methods=['POST'])
def check_guess():
    word = request.form['word']
    guess = request.form['guess']
    attempts_left = int(request.form['attempts_left'])
    
    if guess == word:
        return jsonify({'result': 'Correct!', 'attempts_left': attempts_left})
    
    attempts_left -= 1
    if attempts_left == 0:
        return jsonify({'result': f'Game Over! The word was {word}.', 'attempts_left': attempts_left})
    else:
        return jsonify({'result': 'Incorrect! Try again.', 'attempts_left': attempts_left})

if __name__ == '__main__':
    app.run(debug=True)
